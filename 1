import time
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.chrome.service import Service
from webdriver_manager.chrome import ChromeDriverManager

def run_headless_browser():
    # ВАША ССЫЛКА ЗДЕСЬ - измените на нужную
    TARGET_URL = "https://vk.com/wall-207959790_83204"
    DURATION_HOURS = 6
    
    try:
        print(f"Запуск headless браузера для: {TARGET_URL}")
        
        # Настройки браузера
        chrome_options = Options()
        chrome_options.add_argument("--headless=new")
        chrome_options.add_argument("--no-sandbox")
        chrome_options.add_argument("--disable-dev-shm-usage")
        chrome_options.add_argument("--disable-gpu")
        chrome_options.add_argument("--mute-audio")
        chrome_options.add_argument("--window-size=1920,1080")
        
        # Отключаем медиа
        prefs = {
            "profile.default_content_setting_values.media_stream_camera": 2,
            "profile.default_content_setting_values.media_stream_mic": 2,
        }
        chrome_options.add_experimental_option("prefs", prefs)
        
        # Устанавливаем драйвер
        service = Service(ChromeDriverManager().install())
        driver = webdriver.Chrome(service=service, options=chrome_options)
        
        # Открываем страницу
        driver.get(TARGET_URL)
        print(f"Страница открыта: {driver.title}")
        
        # Ждем 6 часов
        print(f"Браузер будет работать {DURATION_HOURS} часов...")
        time.sleep(DURATION_HOURS * 3600)
        
        # Закрываем
        driver.quit()
        print("Браузер закрыт")
        
    except Exception as e:
        print(f"Ошибка: {e}")

if __name__ == "__main__":
    run_headless_browser()
